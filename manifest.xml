<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    body { font-family: sans-serif; padding: 10px; width: 100%; box-sizing: border-box; }
    h3 { margin-top: 0; }
    button {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 14px;
      cursor: pointer;
      background-color: #0078d4;
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover {
      background-color: #005a9e;
    }
    .log {
      margin-top: 20px;
      font-size: 13px;
      color: #444;
    }
  </style>
</head>
<body>
  <h3>üìä Distribution Calculators</h3>

  <button id="btnNormal">Normal-Distribution</button>
  <button id="btnT">t Distribution</button>
  <button id="btnChiSquare">Chi-square</button>
  <button id="btnF">F Distribution</button>

  <div id="logPanel" class="log"></div>

  <script>
    function log(msg) {
      const div = document.getElementById("logPanel");
      const p = document.createElement("p");
      p.textContent = msg;
      div.appendChild(p);
    }

    if (typeof Office !== "undefined" && Office.onReady) {
      Office.onReady((info) => {
        log("‚úÖ Office.js is ready");

        if (info.host === Office.HostType.Excel) {
          log("‚úÖ Running inside Excel");

          const pageMap = {
            Normal: "Normal.html",
            T: "T.html",
            ChiSquare: "ChiSquare.html",
            F: "F.html"
          };

          function openDistribution(type) {
            const baseURL = "https://avibenita.github.io/Statistical-Calculator/";
            const page = pageMap[type];

            if (!page) {
              log("‚ùå Unknown distribution type: " + type);
              return;
            }

            const fullPath = baseURL + page;
            log("üîó Attempting to open: " + fullPath);

            Office.context.ui.displayDialogAsync(
              fullPath,
              { height: 60, width: 80, displayInIframe: true },
              function (result) {
                if (result.status !== Office.AsyncResultStatus.Succeeded) {
                  log("‚ùå Failed to open dialog");
                } else {
                  log("‚úÖ Dialog opened successfully");
                }
              }
            );
          }

          document.getElementById("btnNormal").onclick = () => openDistribution("Normal");
          document.getElementById("btnT").onclick = () => openDistribution("T");
          document.getElementById("btnChiSquare").onclick = () => openDistribution("ChiSquare");
          document.getElementById("btnF").onclick = () => openDistribution("F");

        } else {
          log("‚ö†Ô∏è Office initialized, but not in Excel. Host: " + info.host);
        }
      });
    } else {
      log("‚ùå Office.js not loaded properly.");
    }
  </script>
</body>
</html>
